---
output:
  md_document:
    variant: markdown_github
---
<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

# Rvoteview

**WARNING: This package is in alpha, as the server and data are currently being revamped. Not all features work, so please limit usage to the simple kind of examples you see below. Also, please limit the number of roll calls you request at a time and be prepared for queries to break or behave strangely.**

This is a package that enables you to query the Voteview database for roll calls and work with data frames or a `pscl` `rollcall` object.

To install this package, ensure you have `devtools` installed. If you do not, run `install.packages("devtools")` before doing the following:
```R
devtools::install_github("JeffreyBLewis/Rvoteview")
```
  
## Using Rvoteview

To use `Rvoteview`, you generally want to query the database to get a list of vote ids and then use those to return the individual votes. We query the database with a search term like so:
```{r search}
library(Rvoteview)
  
res <- voteview_search("Iraq")
names(res)
  
## I will drop description since it is a very long field
head(res[, -1])
```
Using `res$id` we can get a `rollcall` object (from the [`pscl` package](https://cran.r-project.org/web/packages/pscl/index.html)) that contains the full set of votes and data for each roll call. Eventually we will either develop additional methods for the `pscl` `rollcall` object.

```{r download, results='hide'}
## Get a rollcall object using the ids, please limit to a few ids for now!
rc <- voteview_download(res$id[1:10])
```
```{r pscl-sum}
## Now this object can be used in many 'pscl' methods
summary(rc)
```

You can also search by start and end date, session, and chamber. Please see the help files for each function after you install the package to see a little more about how they work.

```{r search-options}
## Voteview search with options
res <- voteview_search("Iraq", chamber = "House", session = 110,
                       startdate = 2008, enddate = "2008-04-20")
head(res[, -1])

res <- voteview_search("Iraq", session = 109:112)
head(res[, -1])

## Currently the 'support' options and the 'query' options do not work
```

